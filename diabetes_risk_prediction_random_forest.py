# -*- coding: utf-8 -*-
"""糖尿病発症予測.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1v_edKztshMyAx41LzD5pStQ2DSfX_ObX

**データセット準備**
"""

# Commented out IPython magic to ensure Python compatibility.
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split

# %matplotlib inline

path = "/content/drive/MyDrive/SIGNATEコンペ/糖尿病発症予測（分類）/"

train = pd.read_csv(path + "train.csv")
test = pd.read_csv(path + "test.csv")
sample = pd.read_csv(path + "sample_submit.csv")

"""**前処理**"""

train.shape, test.shape

train.head()

#trainの欠損値
train.isnull().sum()

#testの欠損値
test.isnull().sum()

"""**特徴量エンジニアリング**"""

#trainの相関関係を可視化
train_corr = train[["Pregnancies", "Glucose", "BloodPressure", "SkinThickness", "Insulin", "BMI", "DiabetesPedigreeFunction", "Age", "Outcome"]].corr()

plt.figure(figsize=(10, 8))
sns.heatmap(train_corr.iloc[:20, :20], annot=True)

#説明変数
x = train[["Pregnancies", "BMI", "Age"]]
#目的変数
y = train["Outcome"]
#推論用変数
z = test[["Pregnancies", "BMI", "Age"]]

#学習用データセットとテスト用データセットに分割
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=0, stratify=y)

"""**モデル学習、検証、推論**"""

#randomforestで学習
from sklearn.ensemble import RandomForestClassifier

model = RandomForestClassifier(random_state=0, n_estimators=100, max_depth=10, min_samples_split=15)
model.fit(x_train, y_train)

#モデル検証
print(f"train score: {model.score(x_train, y_train)}")
print(f"test score: {model.score(x_test, y_test)}")

